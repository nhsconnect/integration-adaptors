resource "aws_route" "opentest_to_base_route" {
  count = var.opentest_connected ? 1 : 0
  route_table_id = data.aws_vpc.opentest_vpc.main_route_table_id
  destination_cidr_block = aws_vpc.base_vpc.cidr_block
  vpc_peering_connection_id = aws_vpc_peering_connection.opentest_peering[0].id
  depends_on = [aws_vpc_peering_connection.opentest_peering[0]]
}

resource "aws_route" "base_to_opentest_route" {
  count = var.opentest_connected ? 1 : 0
  route_table_id = aws_route_table.private.id
  destination_cidr_block = data.aws_vpc.opentest_vpc.cidr_block
  vpc_peering_connection_id = aws_vpc_peering_connection.opentest_peering[0].id
  depends_on = [aws_vpc_peering_connection.opentest_peering[0]]
}
